---
title: 卷积神经网络
date: 2020-01-16 19:22:28
tags:
---
* kernal/fiter: 过滤器  
* 星号：卷积标志
<!--more-->
# 垂直边缘检测
![](https://upload-images.jianshu.io/upload_images/13964980-150b22d95874beb3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
图中的3*3的filter可以检测垂直边缘 

sobel filter(改进)

1| 0|-1
---|---|---
2 | 0|-2
2 | 0|-1
scharr filter
3| 0|-3
---|---|---
10 | 0|-10
3 | 0|-3
# 直接卷积的缺点
1. 输出缩小
2. 丢失边缘信息（边缘像素点输出中采用较少）

# padding
为了解决这一缺点，可在边缘填充像素点
* 原矩阵：n*n
* 过滤器：f*f
* p=padding
* 一次卷积后得到的矩阵：(n+2p-f+1)*(n+2p-f+1)

# valid and same convolutions
* valid: **no padding** p  = 0   
eg.n×n * f×f->n-f+1 × n-f+1  
6×6 * 3×3 -> 4×4
* same: pad so that otput size is **the same as** the input size  
n×n -> n+2p-f+1 × n+2p-f+1  
make p = (f-1)/2   
> f is usually odd

stride S != 1 时
n×n -> floor[(n+2p-f)/2] × floor[(n+2p-f)/2]  

# multiple filters
**n × n × nc(#channels)  *  f × f × nc  -->  n-f+1 × n-f+1 × nc'(#filters)**  
RGB: 3 channels,then nc = 3  

# types of layer in a Conv Net 
(three common types)
1. convolution(卷积层)(CONV)
2. pooling(池化层)(POOL)
3. fully-connected(全连接层)(FC)  


# pooling
## max pooling (used more often)  
![image.png](https://upload-images.jianshu.io/upload_images/13964980-63ebc62cb7e78e25.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
## average pooling 
## summary  
* hyperparameters:   
  f: filter size  
  s: stride   
  max or average pooling

* input: nH × nW × nC
* output:[(nH-f)/s + 1] × [(nH-f)/s + 1] × nC 
* NO PARAMETERS TO LEARN

# neural network example
![image.png](https://upload-images.jianshu.io/upload_images/13964980-d7505c1a431097e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240) 
layer1 = CONV1 +POOL1
